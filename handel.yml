version: 1

name: infohub

tags:
  data-sensitivity: public
  team: OIT-Tools

environments:
  dev:
    app:
      type: ecs
      containers:
        - name: infohub
          image_name: <account>/infohub:dev
          port_mappings:
            - 80
          max_mb: 1024
          cpu_units: 1024
          routing:
            base_path: /
            health_check_path: /ping.html
      auto_scaling:
        min_tasks: 1
        max_tasks: 1
      cluster:
        key_name: ndpete21-oittools
        instance_type: t3.medium
      load_balancer:
        type: https
        https_certificate: 13c2b320-38c5-46d4-8c8b-7e2c21501b00
        dns_names:
          - infohub-dev.byu.edu
      dependencies:
      - db
      - storage
    db:
      type: mysql
      mysql_version: 5.7.23
      database_name: infohub
      instance_type: db.t2.micro
      storage_type: gp2
    storage:
      type: efs
  prd:
    dns:
      type: route53zone
      name: infohub.byu.edu
    app:
      type: ecs
      containers:
        - name: infohub
          image_name: <account>/infohub:prd
          port_mappings:
            - 80
          max_mb: 1024
          cpu_units: 1280
          routing:
            base_path: /
            health_check_path: /ping.html
      auto_scaling:
        min_tasks: 2
        max_tasks: 2
      cluster:
        key_name: ndpete21-oittools
        instance_type: t3.medium
      load_balancer:
        type: https
        https_certificate: 314b34b4-ab78-4029-b847-f0de3fb1e94d
        dns_names:
          - infohub.byu.edu
      dependencies:
      - db
      - storage
    db:
      type: mysql
      mysql_version: 5.7.26
      database_name: infohub
      instance_type: db.t2.micro
      storage_type: gp2
    storage:
      type: efs
